---
title: Basic Goal-Oriented Agent
description: Agent that manages goals and tasks with simple memory and actions.
---

## 1. Environment setup and imports

```typescript title="index.ts"
import { createDreams, context, action, validateEnv } from "@daydreamsai/core";
import { cliExtension } from "@daydreamsai/cli";
import { anthropic } from "@ai-sdk/anthropic";
import { z } from "zod";

validateEnv(
  z.object({
    ANTHROPIC_API_KEY: z.string().min(1, "ANTHROPIC_API_KEY is required"),
  })
);
```

The agent requires an Anthropic API key for the Claude language model. Set this
environment variable before running the agent.

## 2. Define the goal context and memory structure

```ts
type GoalMemory = {
  goal: string;
  tasks: string[];
  currentTask: string;
};

const goalContext = context({
  type: "goal",
  schema: z.object({
    id: z.string(),
  }),
  key: ({ id }) => id,
  create: () => ({
    goal: "",
    tasks: [],
    currentTask: "",
  }),
  render: ({ memory }) => `
Current Goal: ${memory.goal || "No goal set"}
Tasks: ${memory.tasks.length > 0 ? memory.tasks.join(", ") : "No tasks"}
Current Task: ${memory.currentTask || "None"}
  `,
});
```

The context maintains the agent's current goal, list of tasks, and which task is
currently active. Memory persists between conversations.

## 3. Define task management actions

```ts
const taskActions = [
  action({
    name: "setGoal",
    description: "Set a new goal for the agent",
    schema: z.object({
      goal: z.string().describe("The goal to work towards"),
    }),
    handler: ({ goal }, ctx) => {
      const memory = ctx.agentMemory as GoalMemory;
      memory.goal = goal;
      memory.tasks = [];
      memory.currentTask = "";
      return { success: true, message: `Goal set to: ${goal}` };
    },
  }),

  action({
    name: "addTask",
    description: "Add a task to accomplish the goal",
    schema: z.object({
      task: z.string().describe("The task to add"),
    }),
    handler: ({ task }, ctx) => {
      const memory = ctx.agentMemory as GoalMemory;
      memory.tasks.push(task);
      if (!memory.currentTask && memory.tasks.length === 1) {
        memory.currentTask = task;
      }
      return { success: true, message: `Added task: ${task}` };
    },
  }),

  action({
    name: "completeTask",
    description: "Mark the current task as complete",
    schema: z.object({
      task: z.string().describe("The task to complete"),
    }),
    handler: ({ task }, ctx) => {
      const memory = ctx.agentMemory as GoalMemory;
      memory.tasks = memory.tasks.filter((t) => t !== task);

      if (memory.currentTask === task) {
        memory.currentTask = memory.tasks[0] || "";
      }

      return {
        success: true,
        message: `Completed task: ${task}`,
        remainingTasks: memory.tasks.length,
      };
    },
  }),
];
```

## 4. Create and start the agent

```ts
createDreams({
  model: anthropic("claude-3-7-sonnet-latest"),
  extensions: [cliExtension],
  context: goalContext,
  actions: taskActions,
}).start({ id: "basic-agent" });
```

## How it works

The basic goal-oriented agent demonstrates core Daydreams functionality:

1. **Context management**: Maintains goal and task state across conversations
2. **Memory persistence**: Agent remembers goals and tasks between sessions
3. **Action system**: LLM can call actions to modify agent state
4. **CLI interaction**: Users can communicate through terminal input/output

**Example conversation:**

```
User: "I want to build a web application"
Agent: *calls setGoal action*
Agent: "I've set your goal to build a web application. Let me add some tasks."

Agent: *calls addTask multiple times*
Agent: "Added tasks: Set up development environment, Design user interface, Implement backend API"

User: "I finished setting up my environment"
Agent: *calls completeTask action*
Agent: "Great! Marked 'Set up development environment' as complete. Next task: Design user interface"
```

The agent automatically manages task progression and maintains awareness of the
current goal state.
